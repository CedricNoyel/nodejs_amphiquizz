<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Amphiquizz - Admin</title>
	<link rel="stylesheet" type="text/css" href="./css/commun.css"/>
	<link rel="stylesheet" type="text/css" href="./css/dashboard.css"/>
	<link rel="stylesheet" type="text/css" href="./css/questionnaire.css"/>
	<script src="../../js/jquery.js"></script>
	<script src="../../js/jquery-ui.js"></script>	
	<script src="/socket.io/socket.io.js"></script>
	<script src="../../js/commun.js"></script>
</head>

<body>	
	<container>
		<div id='listeQuestionnaires'>
			<table>
				<thead><tr><th>nom du questionnaire</th> <th>nombres <br>de questions</th><th>etat</th></tr></thead>
				<tbody>	    <!--	QUESTIONNAIRES	-->		</tbody>
		    </table>
		    
		    <div class="buttonContainer">
		    	<button class="bouton" type="button" id='addQuestionnaire' >Nouveau questionnaire</button>
		    	<button class="bouton" type="button" id='fastQuestion' >Question rapide</button>
		    </div>
	    </div>
	</container>
</body>

<script>
    // Demande et affichage questionnaires de l'utilisateur
    socket.emit('req_user_quest');
    socket.on('res_user_quest', function(user_quest){
    	console.log(user_quest);
    	for(var i in user_quest){
    		if (user_quest[i].ETAT_QUESTIONNAIRE == "Valide"){
    			var trString = '<tr onclick="quest_show(\'' + user_quest[i].ID_QUESTIONNAIRE + '\');" ><td>' + user_quest[i].NOM_QUESTIONNAIRE + '</td><td>' + user_quest[i].nb_questions + '</td> <td class="complet">' + user_quest[i].ETAT_QUESTIONNAIRE + '</td></tr>';
    		} else {
    			var trString = '<tr onclick="quest_show(\'' + user_quest[i].ID_QUESTIONNAIRE + '\');" ><td>' + user_quest[i].NOM_QUESTIONNAIRE + '</td><td>' + user_quest[i].nb_questions + '</td> <td class="imcomplet">' + user_quest[i].ETAT_QUESTIONNAIRE + '</td></tr>';
    		}
    		$('table').append(trString);
    	}
    });

    // Ajout d'un questionnaire
    $('#addQuestionnaire').click(function(){
    	var nom_questionnaire = '';
    	socket.emit('req_add_questionnaire', nom_questionnaire);
    	socket.on('res_add_questionnaire', function(id_quest){
			document.location.href = './questionnaire/'+ id_quest;
    	});
    });

    // Affichage d'un questionnaire
	function quest_show(id_questionnaire){
		document.location.href=  "/questionnaire/" + id_questionnaire;
	};

	$('#fastQuestion').click(function(){
		document.location.href=  "/fastquestion/" + '1';
	});

</script>
</html>